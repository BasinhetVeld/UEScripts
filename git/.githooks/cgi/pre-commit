# CGI pre-commit hooks

#!/bin/sh

# Get a list of all staged files
staged_files=$(git diff --cached --name-only)

# Check if there are any changes outside the Plugins/Content directory
for file in $staged_files; do
  
  # Allow anything inside Plugins/Content
  if [[ "$file" == Plugins/Content/* ]]; then
    continue
  fi
  
  # Allow submodule pointer update to Plugins/Content
  if [[ "$file" == "Plugins/Content" ]]; then
    type=$(git ls-files --stage "$file" | awk '{print $1}')
    if [[ "$type" == "160000" ]]; then
      continue
    fi
  fi
  
  echo "You are trying to commit changes outside of Plugins/Content: $file"
  echo "Only changes inside Plugins/Content are allowed."
  exit 1
done

exit 0